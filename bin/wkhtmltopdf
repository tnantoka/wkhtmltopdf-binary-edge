#!/usr/bin/env ruby

require 'rbconfig'

arch = RbConfig::CONFIG["host_cpu"] # x86_64, ...
os   = RbConfig::CONFIG["target_os"] # linux, darwin

suffix = if os.eql?('linux')
           if arch.eql?('x86_64')
            'linux-amd64'
           elsif arch.eql('x86')
             'linux-x86'
           end
         elsif os =~ /darwin/
           'darwin-x86'
         else
           raise "Invalid platform. Must be running linux or intel-based Mac OS."
         end

args = $*.map { |x| x.include?(' ') ? "'" + x + "'" : x }
cmd = File.expand_path "#{File.dirname(__FILE__)}/../libexec/wkhtmltopdf-#{suffix}"

exec "#{cmd} #{args.join(' ')}"
